@using Bank.UI.Models.Profile.Response
@model UserProfileDetailsResponse

@{
    bool isCompleted = Model.Flag;
}

<div class="modal-header">
    <h5 class="modal-title">My Profile</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">
    <form id="profileForm">

        <input asp-for="UserId" type="hidden" />
        <input asp-for="Flag" type="hidden" />

        <!-- Name -->
        <div class="mb-3">
            <label>Full Name</label>
            <input asp-for="Name"
                   class="form-control"
                   readonly />
        </div>

        <!-- Email -->
        <div class="mb-3">
            <label>Email</label>
            <input asp-for="Email"
                   class="form-control"
                   readonly />
        </div>

        <!-- Mobile -->
        <div class="mb-3">
            <label>Mobile</label>

            @if (isCompleted)
            {
                <input asp-for="Mobile" class="form-control" disabled maxlength="10" />
            }
            else
            {
                <input asp-for="Mobile" class="form-control" maxlength="10" />
            }
        </div>


        <!-- Address -->
        <div class="mb-3">
            <label>Address</label>
            @if (isCompleted)
            {
                <textarea asp-for="Address" class="form-control" rows="3" disabled></textarea>
            }
            else
            {
                <textarea asp-for="Address" class="form-control" rows="3"></textarea>
            }
        </div>

        <!-- DOB -->
        <div class="mb-3">
            <label>Date of Birth</label>
            @if (isCompleted)
            {
                <input asp-for="DateOfBirth" type="date" class="form-control" disabled />
            }
            else
            {
                <input asp-for="DateOfBirth" type="date" class="form-control" />
            }
        </div>

        <!-- Gender -->
        <div class="mb-3">
            <label>Gender</label>
            @if (isCompleted)
            {
                <select asp-for="Gender" class="form-select" disabled>
                    <option value="">-- Select --</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            }
            else
            {
                <select asp-for="Gender" class="form-select">
                    <option value="">-- Select --</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            }

        </div>

    </form>
</div>

<div class="modal-footer">
    <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

    @if (!isCompleted)
    {
        <!-- First-time profile completion -->
        <button class="btn btn-primary"
                type="button"
                onclick="saveProfile('false')">
            Save Changes
        </button>
    }
    else
    {
        <!-- Existing profile -->
        <button id="editBtn"
                class="btn btn-warning"
                type="button"
                onclick="enableEdit()">
            Edit Details
        </button>

        <button id="saveBtn"
                class="btn btn-primary d-none"
                type="button"
                onclick="saveProfile()">
            Save Changes
        </button>
    }
</div>
